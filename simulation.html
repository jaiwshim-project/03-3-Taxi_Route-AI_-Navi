<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>수익 시뮬레이션 - 택시내비AI</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link rel="stylesheet" as="style" crossorigin
        href="https://cdn.jsdelivr.net/gh/orioncactus/pretendard@v1.3.9/dist/web/variable/pretendardvariable-dynamic-subset.min.css" />
  <link rel="stylesheet" href="css/custom.css">
</head>
<body class="bg-gray-50 text-gray-900 min-h-screen flex flex-col">

  <!-- ========== 헤더 ========== -->
  <div id="app-header"></div>

  <!-- ========== 메인 컨텐츠 ========== -->
  <main class="flex-1 max-w-7xl mx-auto w-full px-4 sm:px-6 py-8">

    <!-- 페이지 타이틀 -->
    <div class="mb-8 animate-fade-in-up">
      <h1 class="text-3xl font-bold text-gray-900 mb-2">
        수익 <span class="gradient-text">시뮬레이션</span>
      </h1>
      <p class="text-gray-500">AI 최적화, 경험 기반, 무작위 운행 전략을 비교하여 예상 수익을 시뮬레이션합니다.</p>
    </div>

    <!-- ===== 1. 시뮬레이션 컨트롤 ===== -->
    <section class="bg-white rounded-2xl shadow-sm border border-gray-100 p-6 mb-8 animate-fade-in-up">
      <h2 class="text-lg font-bold text-gray-800 mb-5 flex items-center gap-2">
        <span class="w-8 h-8 bg-amber-100 rounded-lg flex items-center justify-center text-base">&#9881;</span>
        시뮬레이션 설정
      </h2>
      <div class="grid sm:grid-cols-4 gap-6 items-end">
        <!-- 도시 선택 -->
        <div>
          <label class="block text-sm font-semibold text-gray-700 mb-2">도시 선택</label>
          <div id="city-select-container"></div>
        </div>
        <!-- 근무시간 슬라이더 -->
        <div>
          <label class="block text-sm font-semibold text-gray-700 mb-2">
            일일 근무시간: <span id="hours-display" class="text-amber-600">10시간</span>
          </label>
          <input id="hours-slider" type="range" min="6" max="14" value="10" step="1"
                 class="w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer accent-amber-500"
                 oninput="document.getElementById('hours-display').textContent=this.value+'시간'">
          <div class="flex justify-between text-xs text-gray-400 mt-1">
            <span>6시간</span><span>10시간</span><span>14시간</span>
          </div>
        </div>
        <!-- 날씨 선택 -->
        <div>
          <label class="block text-sm font-semibold text-gray-700 mb-2">날씨 조건</label>
          <select id="weather-select"
                  class="w-full rounded-xl border border-gray-200 px-4 py-2.5 text-sm focus:ring-2 focus:ring-amber-400 focus:border-amber-400 outline-none bg-white">
            <option value="clear">&#9728;&#65039; 맑음</option>
            <option value="cloudy">&#9729;&#65039; 흐림</option>
            <option value="rain">&#127783;&#65039; 비</option>
            <option value="heavy_rain">&#9748; 폭우</option>
            <option value="snow">&#10052;&#65039; 눈</option>
          </select>
        </div>
        <!-- 실행 버튼 -->
        <div>
          <button id="run-btn" onclick="runSimulation()"
                  class="w-full bg-amber-500 hover:bg-amber-600 text-white font-bold py-2.5 px-6 rounded-xl shadow-lg shadow-amber-200 transition-all active:scale-95 flex items-center justify-center gap-2">
            <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M14.752 11.168l-3.197-2.132A1 1 0 0010 9.87v4.263a1 1 0 001.555.832l3.197-2.132a1 1 0 000-1.664z"/><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 12a9 9 0 11-18 0 9 9 0 0118 0z"/></svg>
            시뮬레이션 실행
          </button>
        </div>
      </div>
    </section>

    <!-- ===== 2. 결과 카드 3열 ===== -->
    <section id="results-section" class="hidden mb-8">
      <div class="grid lg:grid-cols-3 gap-6" id="strategy-cards"></div>
    </section>

    <!-- ===== 3. 시간대별 수익 차트 ===== -->
    <section id="chart-section" class="hidden bg-white rounded-2xl shadow-sm border border-gray-100 p-6 mb-8">
      <h2 class="text-lg font-bold text-gray-800 mb-2 flex items-center gap-2">
        <span class="w-8 h-8 bg-blue-100 rounded-lg flex items-center justify-center text-base">&#128202;</span>
        시간대별 수익 비교
      </h2>
      <p class="text-sm text-gray-500 mb-5">각 전략의 시간대별 매출 추이를 확인하세요.</p>
      <!-- 범례 -->
      <div class="flex flex-wrap gap-4 mb-4 text-sm">
        <span class="flex items-center gap-1.5"><span class="w-3 h-3 rounded-sm bg-amber-500 inline-block"></span> AI 최적화</span>
        <span class="flex items-center gap-1.5"><span class="w-3 h-3 rounded-sm bg-blue-500 inline-block"></span> 경험 기반</span>
        <span class="flex items-center gap-1.5"><span class="w-3 h-3 rounded-sm bg-gray-400 inline-block"></span> 무작위</span>
      </div>
      <div id="hourly-chart" class="overflow-x-auto"></div>
    </section>

    <!-- ===== 4. 월간 수익 프로젝션 ===== -->
    <section id="monthly-section" class="hidden bg-white rounded-2xl shadow-sm border border-gray-100 p-6 mb-8">
      <h2 class="text-lg font-bold text-gray-800 mb-2 flex items-center gap-2">
        <span class="w-8 h-8 bg-green-100 rounded-lg flex items-center justify-center text-base">&#128176;</span>
        월간 수익 프로젝션
      </h2>
      <p class="text-sm text-gray-500 mb-5">일일 시뮬레이션 결과를 기반으로 주간/월간 예상 수익을 산출합니다. (월 25일 근무 기준)</p>
      <div class="overflow-x-auto">
        <table class="data-table text-sm" id="monthly-table">
          <thead>
            <tr>
              <th class="rounded-tl-lg">구분</th>
              <th>AI 최적화</th>
              <th>경험 기반</th>
              <th>무작위 운행</th>
            </tr>
          </thead>
          <tbody id="monthly-tbody"></tbody>
        </table>
      </div>
    </section>

    <!-- ===== 5. 핵심 인사이트 ===== -->
    <section id="insights-section" class="hidden mb-8">
      <h2 class="text-lg font-bold text-gray-800 mb-5 flex items-center gap-2">
        <span class="w-8 h-8 bg-purple-100 rounded-lg flex items-center justify-center text-base">&#128161;</span>
        핵심 인사이트
      </h2>
      <div class="grid sm:grid-cols-3 gap-6" id="insights-cards"></div>
    </section>

  </main>

  <!-- ========== 푸터 ========== -->
  <div id="app-footer"></div>

  <!-- ========== 스크립트 ========== -->
  <script src="js/mock-data.js"></script>
  <script src="js/shared.js"></script>
  <script src="js/demand-engine.js"></script>
  <script>
  /* ═══════════════════════════════════════════
     시뮬레이션 페이지 로직
     ═══════════════════════════════════════════ */

  initPage('simulation');

  // 도시 선택 드롭다운 삽입
  document.getElementById('city-select-container').innerHTML =
    buildCitySelectHTML('simCitySelect', 'onSimCityChange(this.value)');

  function onSimCityChange(cityKey) {
    switchCity(cityKey);
    // 결과가 보이는 상태면 자동 재실행
    if (!document.getElementById('results-section').classList.contains('hidden')) {
      runSimulation();
    }
  }

  /* ---------- 전략 메타 ---------- */
  var strategies = [
    {
      key: 'ai',
      name: 'AI 최적화 전략',
      icon: '&#129302;',
      iconBg: 'bg-amber-100',
      borderColor: 'border-amber-400',
      headerBg: 'bg-gradient-to-r from-amber-500 to-orange-500',
      barColor: 'bg-amber-500',
      desc: 'AI가 실시간 수요 데이터를 분석하여 최적의 승객 픽업 위치로 안내합니다.'
    },
    {
      key: 'experienced',
      name: '경험 기반 전략',
      icon: '&#128104;&#8205;&#9877;&#65039;',
      iconBg: 'bg-blue-100',
      borderColor: 'border-blue-400',
      headerBg: 'bg-gradient-to-r from-blue-500 to-indigo-500',
      barColor: 'bg-blue-500',
      desc: '숙련된 기사님의 경험과 감에 의존하여 운행합니다.'
    },
    {
      key: 'random',
      name: '무작위 운행 전략',
      icon: '&#127922;',
      iconBg: 'bg-gray-100',
      borderColor: 'border-gray-300',
      headerBg: 'bg-gradient-to-r from-gray-500 to-gray-600',
      barColor: 'bg-gray-400',
      desc: '특별한 전략 없이 무작위로 운행하는 방식입니다.'
    }
  ];

  /* ---------- 시뮬레이션 실행 ---------- */
  function runSimulation() {
    var hours = parseInt(document.getElementById('hours-slider').value);
    var weather = document.getElementById('weather-select').value;

    // 버튼 로딩 상태
    var btn = document.getElementById('run-btn');
    btn.disabled = true;
    btn.innerHTML = '<span class="spinner"></span> 분석 중...';

    setTimeout(function() {
      var results = {};
      strategies.forEach(function(s) {
        results[s.key] = simulateRevenue(s.key, hours, HOTSPOTS, weather);
      });

      renderStrategyCards(results, hours);
      renderHourlyChart(results);
      renderMonthlyProjection(results);
      renderInsights(results);

      // 섹션 표시
      document.getElementById('results-section').classList.remove('hidden');
      document.getElementById('chart-section').classList.remove('hidden');
      document.getElementById('monthly-section').classList.remove('hidden');
      document.getElementById('insights-section').classList.remove('hidden');

      // 결과로 스크롤
      document.getElementById('results-section').scrollIntoView({ behavior: 'smooth', block: 'start' });

      btn.disabled = false;
      btn.innerHTML = '<svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M14.752 11.168l-3.197-2.132A1 1 0 0010 9.87v4.263a1 1 0 001.555.832l3.197-2.132a1 1 0 000-1.664z"/><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 12a9 9 0 11-18 0 9 9 0 0118 0z"/></svg> 시뮬레이션 실행';
    }, 800);
  }

  /* ---------- 2. 전략 카드 렌더링 ---------- */
  function renderStrategyCards(results, hours) {
    var container = document.getElementById('strategy-cards');

    // 최고/최저 순수익 판별
    var netValues = strategies.map(function(s) { return results[s.key].netIncome; });
    var maxNet = Math.max.apply(null, netValues);
    var minNet = Math.min.apply(null, netValues);

    var html = '';
    strategies.forEach(function(s, idx) {
      var r = results[s.key];
      var isMax = r.netIncome === maxNet;
      var isMin = r.netIncome === minNet;
      var rankBadge = '';
      if (isMax) {
        rankBadge = '<span class="absolute -top-3 -right-3 bg-green-500 text-white text-xs font-bold px-3 py-1 rounded-full shadow-lg">BEST</span>';
      } else if (isMin) {
        rankBadge = '<span class="absolute -top-3 -right-3 bg-red-400 text-white text-xs font-bold px-3 py-1 rounded-full shadow-lg">WORST</span>';
      }

      var borderHighlight = isMax ? 'ring-2 ring-green-400' : isMin ? 'ring-2 ring-red-300' : '';

      html += '<div class="relative bg-white rounded-2xl shadow-sm border border-gray-100 overflow-hidden card-hover animate-fade-in-up ' + borderHighlight + '" style="animation-delay:' + (idx * 0.1) + 's">' +
        rankBadge +
        /* 카드 헤더 */
        '<div class="' + s.headerBg + ' text-white px-6 py-4">' +
          '<div class="flex items-center gap-3">' +
            '<span class="text-2xl">' + s.icon + '</span>' +
            '<div>' +
              '<h3 class="font-bold text-base">' + s.name + '</h3>' +
              '<p class="text-white/80 text-xs mt-0.5">' + s.desc + '</p>' +
            '</div>' +
          '</div>' +
        '</div>' +
        /* 카드 본문 */
        '<div class="px-6 py-5 space-y-4">' +
          /* 순수익 강조 */
          '<div class="text-center py-3 rounded-xl ' + (isMax ? 'bg-green-50' : isMin ? 'bg-red-50' : 'bg-gray-50') + '">' +
            '<p class="text-xs text-gray-500 mb-1">순수익 (연료비 차감)</p>' +
            '<p class="text-2xl font-extrabold ' + (isMax ? 'text-green-600' : isMin ? 'text-red-500' : 'text-gray-800') + '">' + fmt(r.netIncome) + '원</p>' +
          '</div>' +
          /* 상세 지표 */
          buildMetricRow('&#128663;', '총 운행 횟수', r.totalTrips + '회', '') +
          buildMetricRow('&#128181;', '총 매출', fmt(r.totalFare) + '원', '') +
          buildMetricRow('&#9981;', '연료비', fmt(r.totalFuel) + '원', 'text-red-500') +
          buildMetricRow('&#127919;', '탑승률', r.occupancyRate + '%', getOccupancyColor(r.occupancyRate)) +
          buildMetricRow('&#128178;', '회당 평균 수익', fmt(r.avgFarePerTrip) + '원', '') +
          /* 탑승률 바 */
          '<div>' +
            '<div class="flex justify-between text-xs text-gray-500 mb-1"><span>탑승률</span><span>' + r.occupancyRate + '%</span></div>' +
            '<div class="h-2 bg-gray-100 rounded-full overflow-hidden">' +
              '<div class="h-full rounded-full transition-all duration-1000 ' + s.barColor + '" style="width:' + r.occupancyRate + '%"></div>' +
            '</div>' +
          '</div>' +
        '</div>' +
      '</div>';
    });

    container.innerHTML = html;
  }

  function buildMetricRow(icon, label, value, colorClass) {
    return '<div class="flex justify-between items-center text-sm">' +
      '<span class="text-gray-500">' + icon + ' ' + label + '</span>' +
      '<span class="font-semibold ' + (colorClass || 'text-gray-800') + '">' + value + '</span>' +
    '</div>';
  }

  function getOccupancyColor(rate) {
    if (rate >= 70) return 'text-green-600';
    if (rate >= 55) return 'text-amber-600';
    return 'text-red-500';
  }

  /* ---------- 3. 시간대별 차트 ---------- */
  function renderHourlyChart(results) {
    var container = document.getElementById('hourly-chart');

    // 모든 전략의 최대 시간당 매출 찾기
    var maxFare = 0;
    strategies.forEach(function(s) {
      results[s.key].hourlyData.forEach(function(hd) {
        if (hd.fare > maxFare) maxFare = hd.fare;
      });
    });
    if (maxFare === 0) maxFare = 1;

    var aiData = results['ai'].hourlyData;
    var expData = results['experienced'].hourlyData;
    var rndData = results['random'].hourlyData;

    // 시간 인덱스 정렬 기준은 aiData (모든 전략 동일 시간대)
    var numHours = aiData.length;

    var html = '<div class="min-w-[640px]">';

    // Y축 눈금 + 차트 영역
    html += '<div class="flex">';
    // Y축 라벨
    html += '<div class="flex flex-col justify-between text-xs text-gray-400 pr-2 py-1" style="min-width:56px;height:260px">' +
      '<span>' + fmt(maxFare) + '원</span>' +
      '<span>' + fmt(Math.round(maxFare * 0.75)) + '</span>' +
      '<span>' + fmt(Math.round(maxFare * 0.5)) + '</span>' +
      '<span>' + fmt(Math.round(maxFare * 0.25)) + '</span>' +
      '<span>0</span>' +
    '</div>';

    // 차트 바 영역
    html += '<div class="flex-1 flex items-end gap-1 border-l border-b border-gray-200 px-1" style="height:260px">';

    for (var i = 0; i < numHours; i++) {
      var aH = aiData[i] ? aiData[i].fare : 0;
      var eH = expData[i] ? expData[i].fare : 0;
      var rH = rndData[i] ? rndData[i].fare : 0;
      var hourLabel = aiData[i] ? formatHour(aiData[i].hour) : '';

      var aPct = Math.max(2, Math.round((aH / maxFare) * 220));
      var ePct = Math.max(2, Math.round((eH / maxFare) * 220));
      var rPct = Math.max(2, Math.round((rH / maxFare) * 220));

      html += '<div class="flex-1 flex flex-col items-center gap-0.5">' +
        '<div class="w-full flex items-end justify-center gap-0.5" style="height:230px">' +
          buildBar('bg-amber-500', aPct, fmt(aH), 'AI') +
          buildBar('bg-blue-500', ePct, fmt(eH), '경험') +
          buildBar('bg-gray-400', rPct, fmt(rH), '무작위') +
        '</div>' +
        '<span class="text-[10px] text-gray-500 mt-1 whitespace-nowrap">' + hourLabel + '</span>' +
      '</div>';
    }

    html += '</div></div>'; // 차트+Y축 끝
    html += '</div>'; // min-w wrapper 끝

    container.innerHTML = html;
  }

  function buildBar(colorClass, height, tooltip, strategyLabel) {
    return '<div class="group relative flex-1 min-w-[6px] max-w-[18px] rounded-t ' + colorClass + ' transition-all duration-700 hover:opacity-80 cursor-pointer" style="height:' + height + 'px">' +
      '<div class="absolute bottom-full left-1/2 -translate-x-1/2 mb-1 hidden group-hover:block bg-gray-800 text-white text-[10px] px-2 py-1 rounded shadow-lg whitespace-nowrap z-10">' +
        strategyLabel + ': ' + tooltip + '원' +
      '</div>' +
    '</div>';
  }

  /* ---------- 4. 월간 프로젝션 ---------- */
  function renderMonthlyProjection(results) {
    var tbody = document.getElementById('monthly-tbody');
    var workDaysWeek = 6;
    var workDaysMonth = 25;

    var ai = results['ai'];
    var exp = results['experienced'];
    var rnd = results['random'];

    // 최대 순수익 판별 (월간)
    var monthlyNets = [ai.netIncome * workDaysMonth, exp.netIncome * workDaysMonth, rnd.netIncome * workDaysMonth];
    var maxMonthlyNet = Math.max.apply(null, monthlyNets);

    function cellColor(val, isNet) {
      if (!isNet) return '';
      if (val === maxMonthlyNet) return 'text-green-600 font-bold';
      if (val === Math.min.apply(null, monthlyNets)) return 'text-red-500';
      return '';
    }

    var rows = [
      {
        label: '&#128197; 일일 매출',
        vals: [ai.totalFare, exp.totalFare, rnd.totalFare],
        isNet: false
      },
      {
        label: '&#9981; 일일 연료비',
        vals: [ai.totalFuel, exp.totalFuel, rnd.totalFuel],
        isNet: false,
        isExpense: true
      },
      {
        label: '&#128178; 일일 순수익',
        vals: [ai.netIncome, exp.netIncome, rnd.netIncome],
        isNet: false,
        highlight: true
      },
      {
        label: '&#128198; 주간 순수익 (6일)',
        vals: [ai.netIncome * workDaysWeek, exp.netIncome * workDaysWeek, rnd.netIncome * workDaysWeek],
        isNet: false
      },
      {
        label: '&#128197; 월간 매출 (25일)',
        vals: [ai.totalFare * workDaysMonth, exp.totalFare * workDaysMonth, rnd.totalFare * workDaysMonth],
        isNet: false
      },
      {
        label: '&#9981; 월간 연료비 (25일)',
        vals: [ai.totalFuel * workDaysMonth, exp.totalFuel * workDaysMonth, rnd.totalFuel * workDaysMonth],
        isNet: false,
        isExpense: true
      },
      {
        label: '&#128176; 월간 순수익 (25일)',
        vals: [ai.netIncome * workDaysMonth, exp.netIncome * workDaysMonth, rnd.netIncome * workDaysMonth],
        isNet: true,
        highlight: true
      }
    ];

    var html = '';
    rows.forEach(function(row) {
      var bgClass = row.highlight ? 'bg-amber-50/50' : '';
      var fontClass = row.highlight ? 'font-bold' : '';
      html += '<tr class="' + bgClass + '">' +
        '<td class="' + fontClass + '">' + row.label + '</td>';
      row.vals.forEach(function(v, i) {
        var c = '';
        if (row.isExpense) {
          c = 'text-red-500';
        } else if (row.isNet) {
          c = cellColor(v, true);
        } else if (row.highlight) {
          c = 'font-semibold';
        }
        html += '<td class="' + c + ' text-right">' + (row.isExpense ? '-' : '') + fmt(v) + '원</td>';
      });
      html += '</tr>';
    });

    // AI 대비 차이 행
    var aiMonthly = ai.netIncome * workDaysMonth;
    var expDiff = aiMonthly - exp.netIncome * workDaysMonth;
    var rndDiff = aiMonthly - rnd.netIncome * workDaysMonth;

    html += '<tr class="bg-green-50 font-bold border-t-2 border-green-200">' +
      '<td>&#128640; AI 대비 차이</td>' +
      '<td class="text-center text-green-600">기준</td>' +
      '<td class="text-right text-red-500">-' + fmt(expDiff) + '원</td>' +
      '<td class="text-right text-red-500">-' + fmt(rndDiff) + '원</td>' +
    '</tr>';

    tbody.innerHTML = html;
  }

  /* ---------- 5. 핵심 인사이트 ---------- */
  function renderInsights(results) {
    var container = document.getElementById('insights-cards');

    var ai = results['ai'];
    var exp = results['experienced'];
    var rnd = results['random'];

    // AI vs 경험 추가 수익 %
    var extraRevPct = exp.netIncome > 0 ? Math.round(((ai.netIncome - exp.netIncome) / exp.netIncome) * 100) : 0;
    // 빈차 시간 감소 % (empty km 비교)
    var emptyReduction = exp.totalEmptyKm > 0 ? Math.round(((exp.totalEmptyKm - ai.totalEmptyKm) / exp.totalEmptyKm) * 100) : 0;
    // 연료비 절약 % (대비 무작위)
    var fuelSaving = rnd.totalFuel > 0 ? Math.round(((rnd.totalFuel - ai.totalFuel) / rnd.totalFuel) * 100) : 0;

    var monthlyExtraWon = (ai.netIncome - exp.netIncome) * 25;

    var cards = [
      {
        icon: '&#128200;',
        iconBg: 'bg-green-100',
        title: '추가 수익',
        value: '+' + extraRevPct + '%',
        valueColor: 'text-green-600',
        desc: 'AI가 경험 기반 대비 <strong>' + extraRevPct + '%</strong> 더 높은 순수익을 달성합니다. 월간 약 <strong>' + fmtWon(monthlyExtraWon) + '</strong> 추가 수익이 발생합니다.'
      },
      {
        icon: '&#128664;',
        iconBg: 'bg-blue-100',
        title: '빈차 시간 감소',
        value: '-' + emptyReduction + '%',
        valueColor: 'text-blue-600',
        desc: 'AI 전략은 빈차 주행 거리를 경험 기반 대비 <strong>' + emptyReduction + '%</strong> 줄여, 승객을 더 빠르게 만납니다.'
      },
      {
        icon: '&#9981;',
        iconBg: 'bg-purple-100',
        title: '연료비 절약',
        value: '-' + fuelSaving + '%',
        valueColor: 'text-purple-600',
        desc: '무작위 운행 대비 연료비를 <strong>' + fuelSaving + '%</strong> 절감합니다. 불필요한 공차 운행이 줄어 비용 효율이 높습니다.'
      }
    ];

    var html = '';
    cards.forEach(function(c, idx) {
      html += '<div class="bg-white rounded-2xl shadow-sm border border-gray-100 p-6 card-hover animate-fade-in-up" style="animation-delay:' + (idx * 0.12) + 's">' +
        '<div class="flex items-center gap-3 mb-4">' +
          '<span class="w-10 h-10 ' + c.iconBg + ' rounded-xl flex items-center justify-center text-xl">' + c.icon + '</span>' +
          '<div>' +
            '<p class="text-sm text-gray-500">' + c.title + '</p>' +
            '<p class="text-2xl font-extrabold ' + c.valueColor + '">' + c.value + '</p>' +
          '</div>' +
        '</div>' +
        '<p class="text-sm text-gray-600 leading-relaxed">' + c.desc + '</p>' +
      '</div>';
    });

    container.innerHTML = html;
  }

  /* ---------- 페이지 로드 시 자동 실행 ---------- */
  document.addEventListener('DOMContentLoaded', function() {
    runSimulation();
  });
  </script>
</body>
</html>
